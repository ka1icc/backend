# URL Shortener

HTTP сервис для сокращения URL с JSON API и простым веб-интерфейсом. Реализация тестового задания на позицию стажера/junior бекенд разработчика в юнит Авто.

## Описание задачи

Сервис позволяет создавать короткие ссылки из длинных URL, аналогично сервисам Bitly, TinyURL и другим. Основная функциональность:

- **Создание короткой ссылки**: Принимает длинный URL и возвращает короткий код
- **Редирект**: При переходе по короткой ссылке автоматически перенаправляет на исходный URL
- **JSON API**: Полноценный REST API для программного использования
- **Веб-интерфейс**: Простой UI для удобного использования

## Технологии

### Backend
- **FastAPI** - современный веб-фреймворк для Python с автоматической генерацией документации
- **SQLAlchemy** - ORM для работы с базой данных
- **SQLite** - база данных для хранения ссылок
- **Uvicorn** - ASGI сервер для запуска приложения

### Code Quality
- **wemake-python-styleguide** - строгий стиль кода
- **PEP8** - стандарт оформления Python кода
- **flake8** - линтер для проверки стиля
- **isort** - инструмент для упорядочивания импортов

## Структура проекта

```
URLProject/
├── main.py                 # Точка входа, API endpoints
├── requirements.txt        # Зависимости проекта
├── pyproject.toml          # Конфигурация проекта
├── .flake8                 # Конфигурация flake8
├── .isort.cfg              # Конфигурация isort
├── README.md               # Этот файл
├── TASK.md                 # Описание задания
└── app/
    ├── db.py              # Настройка базы данных
    ├── crud.py            # Операции с БД (CRUD)
    ├── domain/
    │   ├── models.py      # SQLAlchemy модели
    │   └── schemas.py     # Pydantic схемы валидации
    └── static/
        └── index.html     # Веб-интерфейс
```

## Требования

- Python >= 3.12
- pip или uv для управления зависимостями

## Инструкция по локальному запуску

### 1. Клонирование репозитория

```bash
git clone <repository-url>
cd URLProject
```

### 2. Установка зависимостей

```bash
# Используя pip
pip install -r requirements.txt

# Или используя uv (быстрее)
uv pip install -r requirements.txt
```

### 3. Запуск приложения

```bash
uvicorn main:app --reload
```

Приложение будет доступно по адресу: `http://localhost:8000`

**Примечание**: База данных SQLite создастся автоматически в файле `shortener.db` при первом запуске.

### 4. Проверка работы

- Откройте браузер: `http://localhost:8000` - веб-интерфейс
- API документация: `http://localhost:8000/docs` - Swagger UI
- Альтернативная документация: `http://localhost:8000/redoc` - ReDoc

## Использование API

### Создание короткой ссылки

```bash
curl -X POST "http://localhost:8000/shorten" \
     -H "Content-Type: application/json" \
     -d '{"target": "https://example.com"}'
```

Ответ:
```json
{
  "code": "abc123",
  "target": "https://example.com",
  "short_url": "http://localhost:8000/abc123"
}
```

### Переход по короткой ссылке

Просто откройте в браузере: `http://localhost:8000/abc123`

Или через curl:
```bash
curl -L "http://localhost:8000/abc123"
```

## Проверка кода

### Проверка стиля (flake8)

```bash
flake8 .
```

### Упорядочивание импортов (isort)

```bash
# Проверка
isort . --check-only

# Автоматическое исправление
isort .
```



### Архитектура приложения

Приложение следует принципам чистой архитектуры:

- **Разделение слоев**: Domain, Application, Infrastructure
- **Dependency Injection**: Использование FastAPI Depends
- **Type Safety**: Полная типизация с type hints
- **Validation**: Валидация на уровне схем (Pydantic)

## API Endpoints

| Метод | Путь | Описание |
|-------|------|----------|
| GET | `/` | Веб-интерфейс |
| POST | `/shorten` | Создание короткой ссылки |
| GET | `/{code}` | Редирект на исходный URL |
| GET | `/docs` | Swagger документация |
| GET | `/redoc` | ReDoc документация |

## Разработка

### Структура кода

- `main.py` - точка входа, определение эндпоинтов
- `app/db.py` - конфигурация базы данных
- `app/crud.py` - операции с базой данных
- `app/domain/models.py` - модели данных (SQLAlchemy)
- `app/domain/schemas.py` - схемы валидации (Pydantic)

### Принципы работы

1. **Создание ссылки**: 
   - Клиент отправляет POST запрос с URL
   - Генерируется уникальный 6-символьный код
   - Сохраняется в БД связка code → target
   - Возвращается короткая ссылка

2. **Редирект**:
   - Клиент переходит по короткой ссылке
   - Сервер ищет код в БД
   - Выполняется HTTP редирект на исходный URL
