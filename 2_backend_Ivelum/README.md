# HTTP Proxy Server for Hacker News

HTTP-прокси-сервер для Hacker News, который модифицирует текст на страницах, добавляя символ ™ после каждого слова из ровно 6 букв.

## Описание проекта

Проект представляет собой простой HTTP-прокси-сервер, который:
- Проксирует запросы к Hacker News (news.ycombinator.com)
- Модифицирует HTML-контент, добавляя ™ после слов из 6 букв
- Переписывает все ссылки на HN, чтобы браузер оставался на адресе прокси
- Сохраняет работоспособность всех ресурсов (CSS, JS, изображения)

## Технологии

- **Python 3.12+** - последняя версия Python
- **http.server** - встроенный HTTP-сервер (стандартная библиотека)
- **urllib** - для HTTP-запросов (стандартная библиотека)
- **re** - регулярные выражения для обработки HTML

Проект использует только стандартную библиотеку Python, без внешних зависимостей.

## Локальный запуск

### Требования

- Python 3.12 или выше
- Доступ к интернету (для запросов к Hacker News)

### Инструкция

1. Клонируйте репозиторий или скачайте файлы проекта

2. Откройте терминал в директории проекта

3. Запустите сервер:
   ```bash
   python main.py
   ```

4. Откройте браузер и перейдите по адресу:
   ```
   http://127.0.0.1:8232
   ```

5. Для остановки сервера нажмите `Ctrl+C` в терминале

### Пример использования

После запуска сервера:
- Главная страница HN: `http://127.0.0.1:8232`
- Конкретная статья: `http://127.0.0.1:8232/item?id=13713480`

Все ссылки на HN будут автоматически переписаны на адрес прокси, а текст будет содержать ™ после слов из 6 букв.

## Запуск в Docker

### Создание Dockerfile

Создайте файл `Dockerfile` в корне проекта:

```dockerfile
FROM python:3.12-slim

WORKDIR /app

COPY main.py .

EXPOSE 8232

CMD ["python", "main.py"]
```

### Сборка и запуск

1. Соберите Docker-образ:
   ```bash
   docker build -t hn-proxy .
   ```

2. Запустите контейнер:
   ```bash
   docker run -d -p 8232:8232 --name hn-proxy hn-proxy
   ```

3. Откройте браузер:
   ```
   http://127.0.0.1:8232
   ```

4. Для остановки контейнера:
   ```bash
   docker stop hn-proxy
   docker rm hn-proxy
   ```

### Docker Compose (опционально)

Создайте файл `docker-compose.yml`:

```yaml
version: '3.8'

services:
  proxy:
    build: .
    ports:
      - "8232:8232"
    restart: unless-stopped
```

Запуск:
```bash
docker-compose up -d
```

Остановка:
```bash
docker-compose down
```

## Архитектура решения

### Основные компоненты

1. **ProxyHandler** - класс-обработчик HTTP-запросов
   - `do_GET()` - обработка GET-запросов
   - `do_POST()` - обработка POST-запросов

2. **add_trademark()** - функция добавления ™ после слов из 6 букв
   - Использует регулярное выражение для поиска слов
   - Обрабатывает только текстовое содержимое

3. **rewrite_urls()** - функция переписывания URL
   - Заменяет абсолютные URL на HN
   - Переписывает относительные пути в атрибутах HTML
   - Сохраняет внешние ссылки без изменений

4. **modify_html()** - функция модификации HTML
   - Извлекает скрипты и стили для защиты от модификации
   - Разделяет HTML на теги и текст
   - Применяет модификации только к тексту
   - Восстанавливает скрипты и стили

### Особенности реализации

- **Обработка скриптов и стилей**: Содержимое `<script>` и `<style>` блоков не модифицируется, чтобы сохранить функциональность страниц
- **Переписывание URL**: Все ссылки на HN переписываются на адрес прокси, внешние ссылки остаются без изменений
- **Обработка ошибок**: Корректная обработка разрыва соединения клиентом
- **Минималистичный код**: Использование только стандартной библиотеки Python

### Регулярные выражения для обработки HTML

Проект использует регулярные выражения для:
- Поиска слов из 6 букв: `\b([a-zA-Z]{6})\b`
- Поиска HTML-тегов: `<[^>]+>`
- Поиска скриптов и стилей: `<script[^>]*>.*?</script>`
- Переписывания URL: `https?://news\.ycombinator\.com([^\s"\'<>]*)`
